这是一份根据您的具体需求整理的、符合行业标准的**产品需求文档 (PRD)**。您可以将此文档直接提供给开发人员（或作为自己开发的蓝图）。

---

# 产品需求文档 (PRD)

# 项目名称：NBA Player Rater (全维球员评级系统)

| **文档版本** | **修改日期** | **修改人** | **备注** |
| --- | --- | --- | --- |
| v1.0 | 2025-11-21 | [您的名字] | 初始版本发布 |

---

## 1. 项目概述 (Project Overview)

### 1.1 背景

当前篮球短视频内容创作领域，对于球员实力的评价多基于主观印象，缺乏统一、客观且可视化的标准体系。创作者需要一个工具来量化球员能力，生成类似《NBA 2K》的评分卡片和雷达图，以提升视频内容的专业度和视觉吸引力。

### 1.2 目标

开发一套基于 Python 的桌面端/Web端工具，能够：

1. **自动获取** NBA 球员实时高阶数据。
2. **差异化计算** 基于三大赛道（后卫/锋线/内线）的加权评分。
3. **可视化输出** 专业级的六维雷达图和评级卡片。
4. **趋势追踪** 记录球员评分变化，支持生成红黑榜。

### 1.3 用户画像

- **主要用户**：篮球视频博主、数据分析师。
- **使用场景**：视频脚本撰写辅助、直播互动评测、生成视频视觉素材。

---

## 2. 功能范围 (Functional Scope)

### 2.1 核心流程

1. **输入**：用户输入球员姓名 -> 选择赛道（模板） -> 调整主观滑块。
2. **处理**：系统拉取 API 数据 -> 清洗数据 -> 映射分数 -> 加权计算总分。
3. **输出**：展示雷达图、数据面板、评级卡片 -> 保存数据至本地数据库。

### 2.2 功能模块清单

| **模块ID** | **模块名称** | **优先级** | **功能描述** |
| --- | --- | --- | --- |
| **F-01** | 数据获取层 | P0 | 通过 `nba_api` 获取球员当赛季常规赛基础与高阶数据。含失败重试与模拟数据机制。 |
| **F-02** | 赛道逻辑配置 | P0 | 内置后卫、锋线、内线三套不同的算法权重与映射规则。 |
| **F-03** | 评分计算引擎 | P0 | 实现 Min-Max 归一化算法，处理不同维度的分数映射（含软上限）。 |
| **F-04** | 主观修正模块 | P1 | 提供 UI 滑块，允许用户手动调整“硬解”、“关键球”等非数据项。 |
| **F-05** | 数据可视化 | P0 | 生成六维雷达图（支持特定配色）、生成 OVR 评级卡片。 |
| **F-06** | 数据持久化 | P2 | 基于 SQLite 存储历史评分，支持查询“历史最高分”或“本周涨幅”。 |

---

## 3. 详细数据逻辑与算法 (Data Logic & Algorithms)

### 3.1 赛道定义 (Archetypes)

系统必须支持以下三种赛道，每种赛道对应不同的计算权重（Weights）和映射标准（Mapping Standards）。

1. **🔵 后卫组 (Guards)**：侧重创造力、射程。
2. **🔴 锋线组 (Wings)**：侧重攻防全能性、硬解。
3. **🟢 内线组 (Bigs)**：侧重护框、篮板、效率。

### 3.2 线性映射算法 (Linear Mapping)

所有客观数据项均采用 Min-Max 归一化公式转换为 60-99 的评分。

- **公式**：$Score = 60 + \frac{(Data - Min)}{(Max - Min)} \times 40$
- **边界处理**：
    - If Data < Min, Score = 60.
    - If Data > Max, Score = 99 (软上限 Soft Cap).
    - 垃圾时间过滤：若 GP < 10 或 MPG < 15，标记为“样本不足”。

### 3.3 维度计算细则

### (1) 终结与得分 (Scoring)

- **核心指标**：真实命中率 (TS%)
- 映射表：
    
    | 赛道 | Min (60分) | Max (99分) | 备注 |
    
    | :--- | :--- | :--- | :--- |
    
    | 后卫 | 50% | 65% | 惩罚低效 |
    
    | 锋线 | 52% | 68% | 均衡 |
    
    | 内线 | 55% | 72% | 奖励吃饼效率 |
    

### (2) 组织能力 (Playmaking)

- **核心指标**：助攻率 (AST%) + 助失比 (AST/TO) 修正
- 映射表：
    
    | 赛道 | Min | Max | 修正规则 |
    
    | :--- | :--- | :--- | :--- |
    
    | 后卫 | 10% | 45% | 若 AST/TO < 2.0，总分 -5 |
    
    | 锋线 | 5% | 30% | - |
    
    | 内线 | 3% | 35% | 适配约基奇模型 |
    

### (3) 投射能力 (Shooting)

- **核心指标**：三分命中率 (3P%) 与 命中数 (3PM)
- **计算逻辑**：`Base_Score = Map(3P%)` + `Volume_Bonus(3PM)`
- **标准**：
    - 后卫：33% 起步，40%+4个/场为满分。
    - 锋线：30% 起步，38%+2.5个/场为满分。
    - 内线：25% 起步，36%+1.5个/场为满分。

### (4) 篮板能力 (Rebounding)

- **核心指标**：篮板率 (REB%)
- 映射表：
    
    | 赛道 | Min | Max |
    
    | :--- | :--- | :--- |
    
    | 后卫 | 3% | 12% |
    
    | 锋线 | 6% | 18% |
    
    | 内线 | 10% | 24% |
    

### (5) 防守能力 (Defense) - 半自动化

- **核心指标**：基础数据 (STL% + BLK%) + 主观修正 (Eye Test Slider)
- **权重**：`最终分 = (数据分 * 0.4) + (滑块分 * 0.6)`
- **数据分公式**：
    - 后卫：`(STL% * 10) + (BLK% * 2) + 60` (Max STL% = 3.0)
    - 内线：`(BLK% * 8) + (STL% * 2) + 60` (Max BLK% = 7.0)
    - 锋线：`(STL% * 6) + (BLK% * 6) + 60`

### (6) 综合评分 (OVR) 权重配置

| **维度** | **后卫权重** | **锋线权重** | **内线权重** |
| --- | --- | --- | --- |
| **终结得分** | 25% | 25% | 20% |
| **组织球商** | 30% | 10% | 10% |
| **防守能力** | 15% | 30% | 35% |
| **篮板保护** | 5% | 10% | 25% |
| **关键属性** | 10% | 10% | 5% |
| **硬解/天赋** | 15% | 15% | 5% |

---

## 4. UI/UX 界面需求 (User Interface)

### 4.1 布局结构 (基于 Streamlit)

- **侧边栏 (Sidebar)**：控制区
    - 输入框：球员姓名搜索 (支持模糊匹配)。
    - 下拉框：赛道选择 (Guards/Wings/Bigs)。
    - 滑块组：硬解能力、防守观感、关键属性 (默认值 75)。
    - 按钮：“生成/更新评级”。
- **主工作区 (Main Area)**：展示区
    - **区域 A - 评级卡片**：包含球员大头照、OVR 总分（超大字号）、Tier 评级徽章（如 T0）。
    - **区域 B - 核心数据看板**：展示 PTS, TS%, AST%, USG% 四个关键数据。
    - **区域 C - 六维雷达图**：大尺寸 SVG/Matplotlib 图表。

### 4.2 视觉规范 (Visual Specs)

- **背景色**：深色模式 (Dark Mode)，RGB `#0E1117`。
- **主题色 (根据赛道动态变化)**：
    - 后卫：**电光蓝 (#00F0FF)**
    - 锋线：**热力红 (#FF0055)**
    - 内线：**翡翠绿 (#00FF99)**
- **雷达图样式**：去除背景网格杂色，半透明填充 (Alpha 0.4)，字体白色高亮。

---

## 5. 技术架构与非功能需求 (Technical & NFR)

### 5.1 技术栈 (Tech Stack)

- **编程语言**：Python 3.9+
- **前端框架**：Streamlit
- **数据处理**：Pandas, NumPy
- **数据源**：`nba_api` (主要), `basketball_reference_scraper` (备用)
- **可视化**：Matplotlib (静态图) 或 Plotly (交互图)
- **数据库**：SQLite (轻量级本地文件存储)

### 5.2 性能与稳定性

- **API 容错**：请求 NBA 官网数据时需添加 `Headers` 伪装浏览器。若超时（>5秒）或报错，自动切换至 **Mock Data (模拟数据模式)** 并提示用户。
- **缓存机制**：使用 `@st.cache_data` 缓存 API 请求结果，有效期 1 小时，避免重复请求导致 IP 被封。

### 5.3 扩展性

- 代码结构需支持未来添加新的数据源（如 EPM 数据 CSV 导入）。
- 支持导出生成的雷达图为高分辨率 PNG 格式。

---

## 6. 开发路线图 (Roadmap)

### 阶段一：核心原型 (MVP)

- **目标**：跑通“输入名字 -> 获取数据 -> 生成雷达图”流程。
- **交付物**：单文件 `app.py`，支持三大赛道基本计算，含模拟数据模式。

### 阶段二：数据持久化与趋势

- **目标**：实现“每日追踪”。
- **功能**：集成 SQLite，每次点击生成时记录数据。新增“历史趋势”Tab，展示 OVR 变化折线图。

### 阶段三：视觉升级与导出

- **目标**：提升视频素材质量。
- **功能**：优化 Matplotlib 绘图参数，使其更符合“赛博朋克/2K”风格。添加“一键下载卡片”功能。

---

## 7. 附录：评级金字塔标准 (Tier Definitions)

- **T0 - 基石/超巨 (OVR 96-99)**: 攻防一体或单项极致，MVP 候选人。
- **T1 - 全明星 (OVR 90-95)**: 球队大当家/二当家，全明星常客。
- **T1.5 - 极品拼图 (OVR 85-89)**: 顶级角色球员，准全明星。
- **T2 - 优质首发 (OVR 80-84)**: 坐稳首发，功能性强。
- **T3 - 轮换 (OVR < 80)**: 替补或边缘球员。

---

*文档结束*